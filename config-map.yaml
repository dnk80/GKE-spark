kind: ConfigMap
apiVersion: v1
metadata:
  name: py-script-map
  namespace: pyfarm
immutable: false
data:
  spark-job-access-gcs.py: |
    import pyspark 
    import sys
    
    BUCKET = "test-gcs"
    inputUri=f"gs://{BUCKET}/test-file.txt" outputUri=f"gs://{BUCKET}/test_file_output"
    sc = pyspark.SparkContext
    lines = sc.textFile(inputUri)
    words = lines.flatMap(lambda line: line.split)
    wordCounts = words.map(lambda word: (word, 1)).reduceByKey(Lambda counti, count2: counti + count2) 
    wordCounts.saveAsTextFile(outputUri)
